<!doctype html><html lang=zh-cn data-theme=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.111.3"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Python 发送电子邮件"><meta itemprop=description content="分享技术,记录生活"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://blog.nealinux.cc/images/logo.jpg"><meta itemprop=keywords content="Python"><meta property="og:type" content="article"><meta property="og:title" content="Python 发送电子邮件"><meta property="og:description" content="分享技术,记录生活"><meta property="og:image" content="/images/logo.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://blog.nealinux.cc/posts/python-send-mail/"><meta property="og:site_name" content="Neal's Blog"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Neal"><meta property="article:published_time" content="2017-12-26 15:13:42 +0000 UTC"><meta property="article:modified_time" content="2017-12-26 15:13:42 +0000 UTC"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.43adb68e4804fb6d0f9296ec597868e0108f79cece8e2924b94ead11ecd8c321.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"python-send-mail","permalink":"https://blog.nealinux.cc/posts/python-send-mail/","title":"Python 发送电子邮件","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Python 发送电子邮件 - Neal's Blog</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Neal's Blog</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>This moment is your life!</p><img class=custom-logo-image src=/images/logo.jpg alt="Neal's Blog"></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-archives"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>55</span></a></li><li class="menu-item menu-item-about"><a href=/about/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#一基本概念>一、基本概念</a></li><li><a href=#二smtp发送邮件>二、SMTP发送邮件</a><ul><li><a href=#zmail-收发邮件>zmail 收发邮件</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Neal src=/imgs/img-lazy-loading.gif data-src=/images/avatar-me.webp><p class=site-author-name itemprop=name>Neal</p><div class=site-description itemprop=description>分享技术,记录生活</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>55</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>15</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>22</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/pengshp title="Github → https://github.com/pengshp" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>Github</a></span>
<span class=links-of-social-item><a href=https://twitter.com/pengshp title="Twitter → https://twitter.com/pengshp" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-twitter fa-fw hvr-icon"></i>Twitter</a></span>
<span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/small/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘</a></li><li class=links-of-blogroll-item><a href=https://www.cnblogs.com/LyShark/ title=https://www.cnblogs.com/LyShark/ target=_blank>LyShark</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=28289-03-28T21:57:02+00:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=38239></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=108></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=25258-04-25T20:37:46+08:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/pengshp rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script>
<script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://blog.nealinux.cc/posts/python-send-mail/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/images/avatar-me.webp"><meta itemprop=name content="Neal"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Neal"><meta itemprop=description content="分享技术,记录生活"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Python 发送电子邮件"><meta itemprop=description content="Email的历史比Web还要久远，直到现在，Email也是互联网上应用非常广泛的服务。本文介绍邮件的传递过程及使用Python实现邮件的发送。"></span><header class=post-header><h1 class=post-title itemprop="name headline">Python 发送电子邮件</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text>发表于：</span>
<time title="发表于：2017-12-26 15:13:42 +0000 UTC" itemprop="dateCreated datePublished" datetime="2017-12-26 15:13:42 +0000 UTC">26263-12-26</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/python itemprop=url rel=index><span itemprop=name>Python</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span><span>2140</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>5分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv class=waline-pageview-count data-path=/posts/python-send-mail/><i class="fa fa-sync fa-spin"></i></span></span>
<span class=post-meta-item title=评论><span class=post-meta-item-icon><i class="far fa-comments"></i></span>
<span class=post-meta-item-text>评论：</span>
<span class=waline-comment-count data-path=/posts/python-send-mail/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>Email的历史比Web还要久远，直到现在，Email也是互联网上应用非常广泛的服务。本文介绍邮件的传递过程及使用Python实现邮件的发送。</p><h2 id=一基本概念>一、基本概念</h2><p>假设我们自己的电子邮件地址是me@163.com，对方的电子邮件地址是friend@sina.com，现在我们用Outlook或者Foxmail之类的软件写好邮件，填上对方的Email地址，点“发送”，电子邮件就发出去了。这些电子邮件软件被称为MUA：Mail User Agent——邮件用户代理。
Email从MUA发出去，不是直接到达对方电脑，而是发到MTA：Mail Transfer Agent——邮件传输代理，就是那些Email服务提供商，比如网易、新浪等等。由于我们自己的电子邮件是163.com，所以，Email首先被投递到网易提供的MTA，再由网易的MTA发到对方服务商，也就是新浪的MTA。
Email到达新浪的MTA后，由于对方使用的是@sina.com的邮箱，因此，新浪的MTA会把Email投递到邮件的最终目的地MDA：Mail Delivery Agent——邮件投递代理。Email到达MDA后，就静静地躺在新浪的某个服务器上，存放在某个文件或特殊的数据库里，我们将这个长期保存邮件的地方称之为电子邮箱。
Email不会直接到达对方的电脑，因为对方电脑不一定开机，开机也不一定联网。对方要取到邮件，必须通过MUA从MDA上把邮件取到自己的电脑上。
所以，一封电子邮件的旅程就是：
发件人 -> MUA -> MTA -> MTA -> 若干个MTA -> MDA &lt;- MUA &lt;- 收件人
发邮件时，MUA和MTA使用的协议就是SMTP：Simple Mail Transfer Protocol；
收邮件时，MUA和MDA使用的协议有两种：</p><ul><li>POP：Post Office Protocol，目前版本是3，俗称POP3；</li><li>IMAP：Internet Message Access Protocol，目前版本是4，优点是不但能取邮件，还可以直接操作MDA上存储的邮件，比如从收件箱移到垃圾箱。</li></ul><p>邮件客户端软件在发邮件时，会让你先配置SMTP服务器，也就是你要发到哪个MTA上。假设你正在使用163的邮箱，你就不能直接发到新浪的MTA上，因为它只服务新浪的用户，所以，你得填163提供的SMTP服务器地址：<code>smtp.163.com</code>，为了证明你是163的用户，SMTP服务器还要求你填写邮箱地址和邮箱口令，这样，MUA才能正常地把Email通过SMTP协议发送到MTA。</p><h2 id=二smtp发送邮件>二、SMTP发送邮件</h2><p>SMTP是发送邮件的协议，Python内置对SMTP的支持，可以发送纯文本邮件、HTML邮件以及带附件的邮件。
Python 对SMTP支持有<code>smtplib</code>和<code>email</code>两个模块，email负责构造邮件，smtplib负责发送邮件。
首先构造一个最简单的纯文本邮件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> email.mime.text <span style=color:#ff79c6>import</span> MIMEText
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> smtplib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msg<span style=color:#ff79c6>=</span>MIMEText(<span style=color:#f1fa8c>&#39;Hello,Send by Python..&#39;</span>,<span style=color:#f1fa8c>&#39;plain&#39;</span>,<span style=color:#f1fa8c>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>from_addr <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;From: &#39;</span>)
</span></span><span style=display:flex><span>password <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;Password: &#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># 收件人地址</span>
</span></span><span style=display:flex><span>to_addr <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;To: &#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>smtp_server <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;SMTP server: &#39;</span>)
</span></span><span style=display:flex><span>server <span style=color:#ff79c6>=</span> smtplib<span style=color:#ff79c6>.</span>SMTP(smtp_server,<span style=color:#bd93f9>25</span>)
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>set_debuglevel(<span style=color:#bd93f9>1</span>)
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>login(from_addr,password)
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>sendmail(from_addr, [to_addr], msg<span style=color:#ff79c6>.</span>as_string())
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>quit()
</span></span></code></pre></div><p>构造MIMEText对象时，第一个参数就是邮件正文，第二个参数是MIME的subtype，传入&rsquo;plain&rsquo;表示纯文本，最终的MIME就是&rsquo;text/plain&rsquo;，最后一定要用utf-8编码保证多语言兼容性。
用<code>set_debuglevel(1)</code>就可以打印出和SMTP服务器交互的所有信息。SMTP协议就是简单的文本命令和响应。<code>login()</code>方法用来登录SMTP服务器，<code>sendmail()</code>方法就是发邮件，由于可以一次发给多个人，所以传入一个list，邮件正文是一个str，<code>as_string()</code>把MIMEText对象变成str。</p><p>测试后发现用上面的方法发送会有问题：
1、邮件没有主题
2、收件人名字显示不友好
3、收到邮件却显示不在不在收件人中</p><p>这是因为邮件主题、如何显示发件人、收件人等信息并不是通过SMTP协议发给MTA，而是包含在发给MTA的文本中的，所以，我们必须把From、To和Subject添加到MIMEText中，才是一封完整的邮件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Send email by Python3</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> email <span style=color:#ff79c6>import</span> encoders
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> email.header <span style=color:#ff79c6>import</span> Header
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> email.mime.text <span style=color:#ff79c6>import</span> MIMEText
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> email.utils <span style=color:#ff79c6>import</span> parseaddr,formataddr
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> smtplib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>_format_addr</span>(s):
</span></span><span style=display:flex><span>	name,addr <span style=color:#ff79c6>=</span> parseaddr(s)
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>return</span> formataddr((Header(name,<span style=color:#f1fa8c>&#39;utf-8&#39;</span>)<span style=color:#ff79c6>.</span>encode(),addr))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>from_addr <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;From: &#39;</span>)
</span></span><span style=display:flex><span>password <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;Password: &#39;</span>)
</span></span><span style=display:flex><span>to_addr <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;To: &#39;</span>)
</span></span><span style=display:flex><span>smtp_server <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>input</span>(<span style=color:#f1fa8c>&#39;SMTP server: &#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msg<span style=color:#ff79c6>=</span>MIMEText(<span style=color:#f1fa8c>&#39;Hello,send by Python...&#39;</span>,<span style=color:#f1fa8c>&#39;plain&#39;</span>,<span style=color:#f1fa8c>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>msg[<span style=color:#f1fa8c>&#39;From&#39;</span>] <span style=color:#ff79c6>=</span> _format_addr(<span style=color:#f1fa8c>&#39;Python爱好 &lt;</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>&gt;&#39;</span> <span style=color:#ff79c6>%</span>from_addr)
</span></span><span style=display:flex><span>msg[<span style=color:#f1fa8c>&#39;To&#39;</span>] <span style=color:#ff79c6>=</span> _format_addr(<span style=color:#f1fa8c>&#39;管理员 &lt;</span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>&gt;&#39;</span> <span style=color:#ff79c6>%</span>to_addr)
</span></span><span style=display:flex><span>msg[<span style=color:#f1fa8c>&#39;Subject&#39;</span>] <span style=color:#ff79c6>=</span> Header(<span style=color:#f1fa8c>&#39;来自SMTP&#39;</span>,<span style=color:#f1fa8c>&#39;utf-8&#39;</span>)<span style=color:#ff79c6>.</span>encode()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>=</span>smtplib<span style=color:#ff79c6>.</span>SMTP(smtp_server,<span style=color:#bd93f9>25</span>)
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>set_debuglevel(<span style=color:#bd93f9>1</span>)
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>login(from_addr,password)
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>sendmail(from_addr, [to_addr], msg<span style=color:#ff79c6>.</span>as_string())
</span></span><span style=display:flex><span>server<span style=color:#ff79c6>.</span>quit()
</span></span></code></pre></div><p>这样便可以发送一个正常额邮件。注意发件人邮箱的密码为客户端授权密码，可网页登录邮箱进入管理后台查看。</p><h3 id=zmail-收发邮件>zmail 收发邮件</h3><p>zmail 是一个更好的用于发送邮件的库，使用简单</p><p>特征:</p><ul><li>自动查找服务器地址及其端口。</li><li>自动使用合适的协议登录。</li><li>自动将python字典转换为MIME对象（带附件）。</li><li>自动添加邮件标题和本地名称，以避免服务器拒绝您的邮件。</li><li>轻松自定义邮件标题。</li><li>支持HTML作为邮件内容。</li><li>只需要python> = 3.5</li></ul><ol><li>安装</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span>pip3 install zmail
</span></span></code></pre></div><ol start=2><li>发送邮件</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>import</span> zmail
</span></span><span style=display:flex><span>server <span style=color:#ff79c6>=</span> zmail<span style=color:#ff79c6>.</span>server(<span style=color:#f1fa8c>&#39;yourmail@example.com’, &#39;</span>yourpassword<span style=color:#f1fa8c>&#39;)</span>
</span></span><span style=display:flex><span>mail <span style=color:#ff79c6>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#39;from&#39;</span>: <span style=color:#f1fa8c>&#39;Zmail &lt;xxxx@163.com&gt;&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#39;subject&#39;</span>: <span style=color:#f1fa8c>&#39;Success!&#39;</span>,  <span style=color:#6272a4># Anything you want.</span>
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#39;content_text&#39;</span>: <span style=color:#f1fa8c>&#39;This message from zmail!&#39;</span>,  <span style=color:#6272a4># Anything you want.</span>
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#39;attachments&#39;</span>: [<span style=color:#f1fa8c>&#39;/Users/zyh/Documents/example.zip&#39;</span>,<span style=color:#f1fa8c>&#39;/root/1.jpg&#39;</span>], <span style=color:#6272a4># 附件</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>                      
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> server<span style=color:#ff79c6>.</span>smtp_able():
</span></span><span style=display:flex><span>	<span style=color:#6272a4># Send mail</span>
</span></span><span style=display:flex><span>	server<span style=color:#ff79c6>.</span>send_mail(<span style=color:#f1fa8c>&#39;yourfriend@example.com&#39;</span>,mail)
</span></span><span style=display:flex><span>	<span style=color:#6272a4># Or to a list of friends.</span>
</span></span><span style=display:flex><span>	server<span style=color:#ff79c6>.</span>send_mail([<span style=color:#f1fa8c>&#39;friend1@example.com&#39;</span>,<span style=color:#f1fa8c>&#39;friend2@example.com&#39;</span>],	mail)
</span></span></code></pre></div><ol start=3><li>接收邮件</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>import</span> zmail
</span></span><span style=display:flex><span>server <span style=color:#ff79c6>=</span> zmail<span style=color:#ff79c6>.</span>server(<span style=color:#f1fa8c>&#39;yourmail@example.com’, &#39;</span>yourpassword<span style=color:#f1fa8c>&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>if</span> server<span style=color:#ff79c6>.</span>pop_able():
</span></span><span style=display:flex><span>	<span style=color:#6272a4># Retrieve mail</span>
</span></span><span style=display:flex><span>	latest_mail <span style=color:#ff79c6>=</span> server<span style=color:#ff79c6>.</span>get_latest()
</span></span><span style=display:flex><span>	zmail<span style=color:#ff79c6>.</span>show(latest_mail)
</span></span></code></pre></div><ol start=4><li>自定义邮件服务器</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>server <span style=color:#ff79c6>=</span> zmail<span style=color:#ff79c6>.</span>server(
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#39;username&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#39;password&#39;</span>,
</span></span><span style=display:flex><span>    smtp_host<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;smtp.163.com&#39;</span>,
</span></span><span style=display:flex><span>    smtp_port<span style=color:#ff79c6>=</span><span style=color:#bd93f9>994</span>,
</span></span><span style=display:flex><span>    smtp_ssl<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>,
</span></span><span style=display:flex><span>    pop_host<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;pop.163.com&#39;</span>,
</span></span><span style=display:flex><span>    pop_port<span style=color:#ff79c6>=</span><span style=color:#bd93f9>995</span>,
</span></span><span style=display:flex><span>    pop_tls<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>项目地址：
<a href=https://github.com/ZYunH/zmail title=https://github.com/ZYunH/zmail rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://github.com/ZYunH/zmail
<i class="fa fa-external-link-alt"></i></a></p></div><footer class=post-footer><div class=post-tags><a href=/tags/python>Python</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/images/ali-pay.jpg alt="Neal - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/images/wechat-pay.jpg alt="Neal - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right><ul><li class=post-copyright-title><strong>文章标题：</strong>
Python 发送电子邮件</li><li class=post-copyright-author><strong>本文作者：</strong>
Neal</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://blog.nealinux.cc/posts/python-send-mail/ title="Python 发送电子邮件">https://blog.nealinux.cc/posts/python-send-mail/</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i></span>
<span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/posts/python3-ipy/ rel=next title="Python 的 IP 地址处理模块 IPy"><i class="fa fa-chevron-left"></i> Python 的 IP 地址处理模块 IPy</a></div><div class="post-nav-prev post-nav-item"><a href=/posts/centos-install-python3/ rel=prev title="CentOS 安装 Python3">CentOS 安装 Python3
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class=switch-btn></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2018 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>Neal</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.111.3 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.4.1 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"busuanzi":{"pageview":true},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":"DIC_kwDOHOpEOM4CPNQ4","emit":false,"inputposition":"top","mapping":"pathname","reactions":false,"repo":"pengshp/pengshp.github.io","repoid":"R_kgDOHOpEOA","theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://blog.nealinux.cc","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"statis":{"enable":true,"plugin":"busuanzi"},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.4.1","waline":{"cfg":{"comment":true,"emoji":false,"imguploader":false,"pageview":true,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.37028fbafbd97fd89808b4c7b5a3a81f01ed0ab24001d273d774f9546a0e9170.js defer></script></body></html>